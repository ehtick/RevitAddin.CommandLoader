# RevitAddin.CommandLoader

[![Revit 2017](https://img.shields.io/badge/Revit-2017+-blue.svg)](../..)
[![Visual Studio 2022](https://img.shields.io/badge/Visual%20Studio-2022-blue)](../..)
[![Nuke](https://img.shields.io/badge/Nuke-Build-blue)](https://nuke.build/)
[![License MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Build](../../actions/workflows/Build.yml/badge.svg)](../../actions)

![CommandLoader](https://github.com/ricaun-io/RevitAddin.CommandLoader/assets/12437519/f54aadb6-5df7-4586-ad08-d4b9e85524d7)

`RevitAddin.CommandLoader` project compiles `IExternalCommand` with Revit open using `CodeDom.Compiler` and creates a `PushButton` on the Revit ribbon.

This project was generated by the [AppLoader](https://ricaun.com/apploader/) Revit plugin.

## Features

* Compile multiple `IExternalCommand` at once with Revit opened.
* Generate `PushButton` with the compiled `IExternalCommand` with `IExternalCommandAvailability`.
* AutoUpdate plugin using [ricaun.Revit.Github](https://github.com/ricaun-io/ricaun.Revit.Github).
* `Gist` link downloads the content and compiles each file.

## Compiler Limitations

Revit 2017 to 2020 the `CodeDom.Compiler` only work with C# compiler version `v4.0` maximum, the following features do not work in C# version 4.
* Async Features (C# version 5)
* String interpolation (C# version 6)

Revit 2021 to 2024 the `CodeDom.Compiler` uses the [Roslyn](https://github.com/aspnet/RoslynCodeDomProvider) version compiler. The Roslyn compiler is a new compiler that supports C# version 6 and above.

Revit 2025+ the `CodeDom.Compiler` uses the [Microsoft.CodeAnalysis.CSharp](https://www.nuget.org/packages/Microsoft.CodeAnalysis.CSharp/) to work with NET Core.

The [RevitAddin.CommandLoader.Tests](RevitAddin.CommandLoader.Tests) have some tests to make sure the compiler works in Net Framework and Net Core.

## Customize `IExternalCommand`

Using `System.ComponentModel` attributes is possible to customize the `IExternalCommand` that is generated in the Revit ribbon.

* `DisplayNameAttribute`: Set the Text in the `PushButton`.
* `DescriptionAttribute`: Set the Tooltip in the `PushButton`.
* `DesignerAttribute`: Set the LargeImage in the `PushButton`. (Works with `component`, `URL`, and `base64`)

If `IExternalCommandAvailability` is added in the same `IExternalCommand` class the availability gonna be applied in the `PushButton`.

### Example

The command below show the version of Revit in a `MessageBox`.

```c#
using System;
using System.ComponentModel;
using Autodesk.Revit.Attributes;
using Autodesk.Revit.DB;
using Autodesk.Revit.UI;

namespace RevitAddin
{
    [DisplayName("Revit\rVersion")]
    [Description("Show a Window with the Revit VersionName.")]
    [Designer("/UIFrameworkRes;component/ribbon/images/revit.ico")]
    [Transaction(TransactionMode.Manual)]
    public class Command : IExternalCommand, IExternalCommandAvailability
    {
        public Result Execute(ExternalCommandData commandData, ref string message, ElementSet elementSet)
        {
            UIApplication uiapp = commandData.Application;
            System.Windows.MessageBox.Show(uiapp.Application.VersionName);
            return Result.Succeeded;
        }
        public bool IsCommandAvailable(UIApplication applicationData, CategorySet selectedCategories)
        {
            return true;
        }
    }
}
```

### Gist Example

The `RevitAddin.CommandLoader` have the feature to download `gist` files from GitHub and compile the `IExternalCommand` with the `gist` file.

Just copy the `gist` link in the `RevitAddin.CommandLoader` compiler and execute. 

* [CommandVersion](https://gist.github.com/ricaun/200a576c3baa45cba034ceedac1e708e) - File with Revit defines.
* [CommandCreate](https://gist.github.com/ricaun/4f62b8650d29f1ff837e7e77f9e8b552) - Multiple file each with a `IExternalCommand`.
* [CommandTheme](https://gist.github.com/ricaun/86334ff6560e3e8c4671148c5c995b39) - Commands to change `UITheme`.

## Resources

* [ricaun.Revit.UI](https://github.com/ricaun-io/ricaun.Revit.UI)
* [ricaun.Revit.Mvvm](https://github.com/ricaun-io/ricaun.Revit.Mvvm)
* [ricaun.Revit.Github](https://github.com/ricaun-io/ricaun.Revit.Github)
* [ricaun.Revit.UI.Tasks](https://github.com/ricaun-io/ricaun.Revit.UI.Tasks)

## Installation

* Download and install [RevitAddin.CommandLoader.exe](../../releases/latest/download/RevitAddin.CommandLoader.zip)

## Video

Videos in Portuguese with the creation of this project.

[![VideoIma1]][Video1]

Videos in English about this project.

[![VideoIma2]][Video2] [![VideoIma3]][Video3] [![VideoIma4]][Video4]

## License

This project is [licensed](LICENSE) under the [MIT License](https://en.wikipedia.org/wiki/MIT_License).

---

Do you like this project? Please [star this project on GitHub](../../stargazers)!

[Video1]: https://youtu.be/4oVJWDRhrRs
[VideoIma1]: https://img.youtube.com/vi/4oVJWDRhrRs/mqdefault.jpg

[Video2]: https://youtu.be/hI21lxm4EVU
[VideoIma2]: https://img.youtube.com/vi/hI21lxm4EVU/mqdefault.jpg
[Video3]: https://youtu.be/cOu7vjZnyXc
[VideoIma3]: https://img.youtube.com/vi/cOu7vjZnyXc/mqdefault.jpg
[Video4]: https://youtu.be/y2GkFXoFwow
[VideoIma4]: https://img.youtube.com/vi/y2GkFXoFwow/mqdefault.jpg
